@page "/"
@using System.Globalization
@using Radzen
@using Radzen.Blazor
@using Radzen.Blazor.Rendering

<PageTitle>Home</PageTitle>

<h1>Hello, world!</h1>

<RadzenScheduler @ref="_scheduler"
                 style="height: 768px;"
                 SlotRender="@OnSlotRender"
                 TItem="Appointment"
                 Data="_appointments"
                 AppointmentRender="args => AppointmentRender(args)"
                 LoadData="args => LoadDataAsync(args)"
                 StartProperty="@nameof(Appointment.Start)"
                 EndProperty="@nameof(Appointment.End)"
                 TextProperty="@nameof(Appointment.Text)">
    <RadzenMonthView Text=""/>
</RadzenScheduler>

@code
{
    private RadzenScheduler<Appointment>? _scheduler;
    private readonly CultureInfo _culture = new("da-DK");
    private Appointment[]? _appointments;

    void OnSlotRender(SchedulerSlotRenderEventArgs args)
    {
        // Highlight today in month view
        if (args.Start.Date == DateTime.Today)
        {
            args.Attributes["style"] = "background: var(--rz-scheduler-highlight-background-color, rgba(255,220,40,.2));";
        }
    }

    private void AppointmentRender(SchedulerAppointmentRenderEventArgs<Appointment> args)
    {
        args.Attributes["style"] = $"background: {args.Data.Color}";
    }

    private async Task LoadDataAsync(SchedulerLoadDataEventArgs args)
    {
        if (_scheduler != null)
        {
            _scheduler.DefaultCulture = _culture;
        }

        _appointments =
        [
            new Appointment
            {
                Start = new DateTime(2025,12,8),
                End = new DateTime(2025,12,8),
                Color = "Orange",
                Text = "8th of Dec",
            },
            new Appointment
            {
                Start = new DateTime(2025,12,9),
                End = new DateTime(2025,12,9),
                Color = "Purple",
                Text = "9th of Dec",
            },
            new Appointment
            {
                Start = new DateTime(2025,11,18),
                End = new DateTime(2025,12,9, 23, 59, 00),
                Color = "Red",
                Text = "18th of Nov to 9th of Dec",
            },

        ];
    }

    private class Appointment
    {
        public required DateTime Start { get; set; }
        public required DateTime End { get; set; }
        public required string Text { get; set; }
        public required string Color { get; init; }
    }
}
